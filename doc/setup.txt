Run Drone and Gogs
1. Login to the VM
vagrant ssh

2. Change to the server directory
cd /vagrant/server

3. Setup environment variables
source setup_env.sh

4. Build Gogs, Drone server, Drone agent docker containers
docker-compose up

Setup Gogs
1. Go to the Gogs page
open a browser to http://192.168.33.10:10080/

2. Set the following options and click register
Change the Database Type to SQLite3
Change the Domain to 192.168.33.10
Change the SSH Port to 10022
Do not select "Use Builtin SSH Server"
Change the Application URL to http://192.168.33.10:10080/

3. Click Register to sign up for an account

4. Create a new repository

5. Give it a name gogs-drone-vm

6. Click "Create Respository"

7. Open your browser to your settings pages
http://192.168.33.10:10080/user/settings

8. Click "SSH Keys" and "Add Key"

9. Copy your public key (use any Key name)
%USERPROFILE%\.ssh\id_rsa.pub on Windows

10. Click add key

11. Add the gogs repository as a remote repository
git remote add gogs ssh://git@192.168.33.10:10022/gavinln/gogs-drone-vm.git

12. Push your code to the gogs repo
git push gogs master

Login to Drone
1. Connect to Drone UI
Open your browser to http://192.168.33.10

2. Login using your Gogs username and password

Other instructions - may not be needed
See instructions here on creating .drone.yml
https://www.digitalocean.com/community/tutorials/how-to-perform-continuous-integration-testing-with-drone-io-on-coreos-and-docker

Setup drone cli
cd ~
curl http://downloads.drone.io/release/linux/amd64/drone.tar.gz | tar zx
sudo install -t /usr/local/bin drone

# authorize CLI
export DRONE_SERVER=http://localhost/
export DRONE_TOKEN=...

# check CLI setup
drone info

# list all repos
drone repo ls

# build a repo
drone build start gavinln/pyswagger-test 1  # build number

Setup Drone and Gogs as shown here
https://discuss.drone.io/t/running-gogs-and-drone-with-docker-compose/173
https://github.com/james-bowman/blog/blob/master/content/post/run-your-own-private-cd-pipeline-with-gogs-drone-and-docker.md
http://www.jamesbowman.me/post/socratic-questions/

Setup Gogs
https://github.com/gogits/gogs/tree/master/docker

# Create local directory for volume.
sudo mkdir -p /var/gogs

Start tmux
tmux

Sign up for an account

Connect to VM using ssh-vm.bat and agent forwarding is enabled

Setup Drone autentication with Github
1. Register Drone as a github application at
https://github.com/settings/applications/new

2. Follow this example
http://readme.drone.io/admin/setup-github/

3. Set up the following
Application name: Drone-test
Homepage URL: http://192.168.33.10
Authorization callback URL: http://192.168.33.10/authorize
